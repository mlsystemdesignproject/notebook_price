# notebook_price

Это приложение позволяет узнать стоимость ноутбука по его характеристикам.
В основе лежит модель машинного обучение, обученная на данных с интернета.

Приложение реализовано в виде telegram бота.
Модель реализована в виде REST API.

## Сбор данных для обучения
Данные собирались с сайта [mvideo.ru](https://www.mvideo.ru).  
Для этого был написан [скрипт](/parsers/mvideo_parser/README.md), который собирал данные с сайта и сохранял их в файлы.

## Анализ и подготовка данных для обучения
Данные были подготовлены для обучения модели.  
Выделены признаки, которые влияют на стоимость ноутбука.  

Для этого был [проведен анализ данных](/notebooks/EDA.ipynb).  
В результате были выделены следующие признаки:
- бренд ноутбука
- бренд процессора
- имя процессора
- частота процессора
- количество процессоров
- тип видеокарты
- объем памяти видеокарты
- диагональ экрана
- объем диска SSD
- объем оперативной памяти
- наличие HDMI разъема
- материал
- время работы от батареи

Также был написан [скрипт](/scripts/prepare_data.py), который подготавливал данные для обучения модели.

## Обучение модели
На основе подготовленных данных было обучено несколько моделей.    
Изучение моделей было проведено в [ноутбуке](/notebooks/model_selection.ipynb).  
В результате лучшую производительность показала модель [CatBoost](https://catboost.ai/).  
Но для продакшена была выбрана модель [NGBoost](https://stanfordmlgroup.github.io/projects/ngboost/), так как она позволяет предсказывать доверительные интервалы.  

## Выбор модели на предсказание доверительных интервалов
Лучшую производительность показала модель CatBoost, но она не предсказывает доверительных интервалов.    
Возникла идея, предсказывать доверительные интервалы как предсказание CatBoost плюс некоторый интервал вокруг него.  
Мы [сравнили модели CatBoost и NGBoost](/notebooks/model_selection_2.ipynb), и оказалось, что модель NGBoost показывает менее широкий интервал, при одинаковой точности попадания в него.  

Также стоит отметить что 95% доверительный интервал по нашему взгляду получился достаточно широким. И чтобы быть более интересным для пользователей стоит уменьшить его ширину, например до 68% (1 сигма).   

## Скрипты для запуска обучения и предсказания

Для обучения модели был написан [скрипт train_model.py](/scripts/train_model.py).  
Для тестового инференса был написан [скрипт predict.py](/scripts/predict.py).  

Пример предсказания:
```
 - Start predicting
 - Reading the model
 - Sample data: {'brand_name': 'lenovo', 'proc_freq': 1.2, 'proc_brand': 'amd', 'proc_name': 'amd', 'proc_count': 2.0, 'videocard': 'radeon', 'videocard_memory': 8.0, 'screen': 11.0, 'ssd_volume': 0, 'ram': 4, 'hdmi': True, 'material': 'пластик', 'battery_life': 8.0}
 - Sample dat price: 29999.000000000007
 - Evaluating model ...
 - Predicted price: 29604.84
 - 95% confidence interval: 21897.62 - 40024.61

```

## Реализация REST API
Модель была развернута на лямбде AWS.
Для этого создан [Dockerfile](Dockerfile), который собирает образ с моделью и запускает сервер на 8080 порту.
URL для запроса: 'https://njs0kuvzkj.execute-api.us-west-1.amazonaws.com/prod/predict-price'

Для тестирования был написан [скрипт](/scripts/predict_lambda.py) для отправки запросов на сервер.

## Написание бота для telegram

## Развертывание приложения

## Pipeline по переобучению модели

## Демонстрация работы приложения



