# notebook_price

Это приложение позволяет узнать стоимость ноутбука по его характеристикам.
В основе лежит модель машинного обучение, обученная на данных с интернета.

Приложение реализовано в виде telegram бота.
Модель реализована в виде REST API.

## Сбор данных для обучения
Данные собирались с сайта [mvideo.ru](https://www.mvideo.ru).  
Для этого был написан [скрипт](/parsers/mvideo_parser/README.md), который собирал данные с сайта и сохранял их в файлы.

## Анализ и подготовка данных для обучения
Данные были подготовлены для обучения модели.  
Выделены признаки, которые влияют на стоимость ноутбука.  

Для этого был [проведен анализ данных](/notebooks/EDA.ipynb).  
В результате были выделены следующие признаки:
- бренд ноутбука
- бренд процессора
- имя процессора
- частота процессора
- количество процессоров
- тип видеокарты
- объем памяти видеокарты
- диагональ экрана
- объем диска SSD
- объем оперативной памяти
- наличие HDMI разъема
- материал
- время работы от батареи

Также был написан [скрипт](/scripts/prepare_data.py), который подготавливал данные для обучения модели.

## Обучение модели
На основе подготовленных данных было обучено несколько моделей.  
Изучение моделей было проведено в [ноутбуке](/notebooks/model_selection.ipynb).
В результате лучшую производительность показала модель [CatBoost](https://catboost.ai/).
Но для продакшена была выбрана модель [NGBoost](https://stanfordmlgroup.github.io/projects/ngboost/), так как она позволяет предсказывать доверительные интервалы.

Для обучения модели был написан [скрипт](/scripts/train_model.py).

Для тестового инференса был написан [скрипт](/scripts/predict.py).  

Пример предсказания:
```
 - Start predicting
 - Reading the model
 - Sample data: {'brand_name': 'lenovo', 'proc_freq': 1.2, 'proc_brand': 'amd', 'proc_name': 'amd', 'proc_count': 2.0, 'videocard': 'radeon', 'videocard_memory': 8.0, 'screen': 11.0, 'ssd_volume': 0, 'ram': 4, 'hdmi': True, 'material': 'пластик', 'battery_life': 8.0}
 - Sample dat price: 29999.000000000007
 - Evaluating model ...
 - Predicted price: 29604.84
 - 95% confidence interval: 21897.62 - 40024.61

```



## Реализация REST API

## Написание бота для telegram

## Развертывание приложения

## Пайплайн по переобучению модели

## Демонстрация работы приложения



